Using device: cuda
CUDA device: NVIDIA GeForce RTX 3060
CUDA memory: 12.5 GB
CUDA compute capability: 8.6
CUDA multiprocessors: 28
CUDA memory allocated: 0.00 GB
CUDA memory cached: 0.00 GB

============================================================
DATA LOADING
============================================================
✓ Loaded data successfully
  - Dataset type: Transformer Keypoints
  - Training folder: data/processed/keypoints_train
  - Validation folder: data/processed/keypoints_val
  - Keypoint key: X
  - Gloss classes: 105
  - Category classes: 10

============================================================
DATASET PREPARATION
============================================================
✓ Created datasets and data loaders
  - Batch size: 32
  - Training batches: 54
  - Validation batches: 14
  - Training dataset size: 1704 samples
  - Validation dataset size: 426 samples
  - Data format: [T, 156] keypoints

============================================================
MODEL SELECTION
============================================================
Available models:
- transformer: Multi-head attention transformer
- iv3_gru: InceptionV3 + GRU hybrid
✓ Using SignTransformer model

================================================================================
COMPREHENSIVE TRAINING CONFIGURATION
================================================================================
Session Information:
  - Start time: 2025-09-17 16:57:01
  - Working directory: /workspace/fslr-transformer-vs-iv3gru
  - Command: /workspace/fslr-transformer-vs-iv3gru/training/train.py --model transformer --keypoints-train data/processed/keypoints_train --keypoints-val data/processed/keypoints_val --labels-train-csv data/processed/train_labels.csv --labels-val-csv data/processed/val_labels.csv --num-gloss 105 --num-cat 10 --epochs 30 --batch-size 32 --amp

System Information:
  - Platform: Linux-5.15.0-153-generic-x86_64-with-glibc2.39
  - Python version: 3.12.11 | packaged by conda-forge | (main, Jun  4 2025, 14:45:31) [GCC 13.3.0]
  - PyTorch version: 2.8.0+cu128
  - CUDA version: 12.8
  - cuDNN version: 91002
  - NumPy version: 2.2.6

Core Training Parameters:
  - Model: transformer
  - Epochs: 30
  - Batch size: 32
  - Learning rate: 0.0001
  - Weight decay: 0.0
  - Gradient clipping: None
  - Loss weights - Alpha: 0.5, Beta: 0.5

Data Configuration:
  - Gloss classes: 105
  - Category classes: 10
  - Data source: Real data files
  - Training folder: data/processed/keypoints_train
  - Validation folder: data/processed/keypoints_val
  - Keypoint key: X

Training Control:
  - Scheduler: None
  - Scheduler patience: 5
  - Early stopping: None
  - Resume from: None

Performance Settings:
  - AMP (Mixed Precision): True
  - Model compilation: False
  - Gradient accumulation steps: 1
  - DataLoader workers: 0
  - Auto workers: False
  - Pin memory: False
  - Prefetch factor: None

Reproducibility:
  - Random seed: 42
  - Deterministic mode: False

Output Configuration:
  - Checkpoint directory: data/processed
  - CSV log file: None

Model Information:
  - Model type: SignTransformer
  - Total parameters: 3,280,627
  - Trainable parameters: 3,280,627
  - Model size: 12.5 MB
================================================================================

============================================================
TRAINING START
============================================================
Training Configuration:
  - Gradient accumulation steps: 1
  - AMP enabled: True
  - Model compiled: False
  - CUDA memory before training: 0.01 GB
Training for 30 epochs...
Loss weights - Gloss: 0.5, Category: 0.5
------------------------------------------------------------
Epoch  1/30 | Train Loss: 3.4811 | Val Loss: 3.4363 | Val Gloss Acc: 0.005 | Val Cat Acc: 0.209 | Time: 4.8s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  2/30 | Train Loss: 3.3623 | Val Loss: 3.2375 | Val Gloss Acc: 0.019 | Val Cat Acc: 0.195 | Time: 2.6s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  3/30 | Train Loss: 3.2464 | Val Loss: 3.1209 | Val Gloss Acc: 0.016 | Val Cat Acc: 0.232 | Time: 2.7s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  4/30 | Train Loss: 3.1656 | Val Loss: 3.0657 | Val Gloss Acc: 0.031 | Val Cat Acc: 0.237 | Time: 2.9s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  5/30 | Train Loss: 3.0958 | Val Loss: 2.9778 | Val Gloss Acc: 0.021 | Val Cat Acc: 0.265 | Time: 2.7s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  6/30 | Train Loss: 3.0187 | Val Loss: 2.9190 | Val Gloss Acc: 0.040 | Val Cat Acc: 0.315 | Time: 3.7s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  7/30 | Train Loss: 2.9428 | Val Loss: 2.8210 | Val Gloss Acc: 0.049 | Val Cat Acc: 0.319 | Time: 2.8s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  8/30 | Train Loss: 2.8131 | Val Loss: 2.6998 | Val Gloss Acc: 0.092 | Val Cat Acc: 0.392 | Time: 2.9s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch  9/30 | Train Loss: 2.7267 | Val Loss: 2.5563 | Val Gloss Acc: 0.106 | Val Cat Acc: 0.439 | Time: 3.6s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 10/30 | Train Loss: 2.6290 | Val Loss: 2.5205 | Val Gloss Acc: 0.127 | Val Cat Acc: 0.413 | Time: 3.0s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 11/30 | Train Loss: 2.5363 | Val Loss: 2.5139 | Val Gloss Acc: 0.110 | Val Cat Acc: 0.387 | Time: 3.5s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 12/30 | Train Loss: 2.4435 | Val Loss: 2.2618 | Val Gloss Acc: 0.183 | Val Cat Acc: 0.488 | Time: 2.8s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 13/30 | Train Loss: 2.3504 | Val Loss: 2.1529 | Val Gloss Acc: 0.181 | Val Cat Acc: 0.526 | Time: 2.5s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 14/30 | Train Loss: 2.2274 | Val Loss: 2.0736 | Val Gloss Acc: 0.202 | Val Cat Acc: 0.542 | Time: 2.7s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 15/30 | Train Loss: 2.1355 | Val Loss: 2.1167 | Val Gloss Acc: 0.178 | Val Cat Acc: 0.469 | Time: 3.2s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 16/30 | Train Loss: 2.1000 | Val Loss: 1.9539 | Val Gloss Acc: 0.235 | Val Cat Acc: 0.570 | Time: 4.2s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 17/30 | Train Loss: 2.0230 | Val Loss: 1.9461 | Val Gloss Acc: 0.237 | Val Cat Acc: 0.523 | Time: 2.6s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 18/30 | Train Loss: 1.9763 | Val Loss: 1.9010 | Val Gloss Acc: 0.230 | Val Cat Acc: 0.570 | Time: 2.7s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 19/30 | Train Loss: 1.9133 | Val Loss: 1.8928 | Val Gloss Acc: 0.270 | Val Cat Acc: 0.559 | Time: 3.1s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 20/30 | Train Loss: 1.8409 | Val Loss: 1.8630 | Val Gloss Acc: 0.272 | Val Cat Acc: 0.535 | Time: 2.9s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 21/30 | Train Loss: 1.8394 | Val Loss: 1.8260 | Val Gloss Acc: 0.265 | Val Cat Acc: 0.573 | Time: 3.8s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 22/30 | Train Loss: 1.7744 | Val Loss: 1.7012 | Val Gloss Acc: 0.310 | Val Cat Acc: 0.606 | Time: 3.1s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 23/30 | Train Loss: 1.7151 | Val Loss: 1.7959 | Val Gloss Acc: 0.293 | Val Cat Acc: 0.573 | Time: 2.9s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 24/30 | Train Loss: 1.6798 | Val Loss: 1.7340 | Val Gloss Acc: 0.300 | Val Cat Acc: 0.601 | Time: 2.9s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 25/30 | Train Loss: 1.6504 | Val Loss: 1.6367 | Val Gloss Acc: 0.317 | Val Cat Acc: 0.617 | Time: 3.1s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 26/30 | Train Loss: 1.6032 | Val Loss: 1.6672 | Val Gloss Acc: 0.317 | Val Cat Acc: 0.610 | Time: 2.8s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 27/30 | Train Loss: 1.6292 | Val Loss: 1.5493 | Val Gloss Acc: 0.366 | Val Cat Acc: 0.655 | Time: 2.7s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 28/30 | Train Loss: 1.6079 | Val Loss: 1.6019 | Val Gloss Acc: 0.329 | Val Cat Acc: 0.622 | Time: 2.9s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 29/30 | Train Loss: 1.5394 | Val Loss: 1.5110 | Val Gloss Acc: 0.359 | Val Cat Acc: 0.643 | Time: 2.8s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
Epoch 30/30 | Train Loss: 1.4741 | Val Loss: 1.4547 | Val Gloss Acc: 0.387 | Val Cat Acc: 0.671 | Time: 2.7s
  GPU Memory: 0.06GB allocated, 0.16GB reserved
------------------------------------------------------------
Training completed!