Using device: cpu
Using CPU
CPU cores: 6 physical, 12 logical
Available RAM: 7.6 GB

============================================================
DATA LOADING
============================================================
✓ Loaded data successfully
  - Dataset type: Transformer Keypoints
  - Training folder: data/processed/keypoints_train
  - Validation folder: data/processed/keypoints_val
  - Keypoint key: X
  - Gloss classes: 105
  - Category classes: 10

============================================================
DATASET PREPARATION
============================================================
✓ Created datasets and data loaders
  - Batch size: 32
  - Training batches: 54
  - Validation batches: 14
  - Training dataset size: 1704 samples
  - Validation dataset size: 426 samples
  - Data format: [T, 156] keypoints

============================================================
MODEL SELECTION
============================================================
Available models:
- transformer: Multi-head attention transformer
- iv3_gru: InceptionV3 + GRU hybrid
✓ Using SignTransformer model

================================================================================
COMPREHENSIVE TRAINING CONFIGURATION
================================================================================
Session Information:
  - Start time: 2025-09-18 00:35:19
  - Working directory: /home/novelle/Documents/fslr-transformer-vs-iv3gru
  - Command: /home/novelle/Documents/fslr-transformer-vs-iv3gru/training/train.py --model transformer --keypoints-train data/processed/keypoints_train --keypoints-val data/processed/keypoints_val --labels-train-csv data/processed/train_labels.csv --labels-val-csv data/processed/val_labels.csv --num-gloss 105 --num-cat 10 --epochs 100 --batch-size 32 --amp

System Information:
  - Platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.39
  - Python version: 3.11.0 (main, Sep 11 2025, 23:19:28) [GCC 13.3.0]
  - PyTorch version: 2.8.0+cu128
  - NumPy version: 2.2.6

Core Training Parameters:
  - Model: transformer
  - Epochs: 100
  - Batch size: 32
  - Learning rate: 0.0001
  - Weight decay: 0.0
  - Gradient clipping: None
  - Loss weights - Alpha: 0.5, Beta: 0.5

Data Configuration:
  - Gloss classes: 105
  - Category classes: 10
  - Data source: Real data files
  - Training folder: data/processed/keypoints_train
  - Validation folder: data/processed/keypoints_val
  - Keypoint key: X

Training Control:
  - Scheduler: None
  - Scheduler patience: 5
  - Early stopping: None
  - Resume from: None

Performance Settings:
  - AMP (Mixed Precision): True
  - Model compilation: False
  - Gradient accumulation steps: 1
  - DataLoader workers: 0
  - Auto workers: False
  - Pin memory: False
  - Prefetch factor: None

Reproducibility:
  - Random seed: 42
  - Deterministic mode: False

Output Configuration:
  - Checkpoint directory: data/processed
  - CSV log file: None

Model Information:
  - Model type: SignTransformer
  - Total parameters: 3,280,627
  - Trainable parameters: 3,280,627
  - Model size: 12.5 MB
================================================================================

============================================================
TRAINING START
============================================================
Training Configuration:
  - Gradient accumulation steps: 1
  - AMP enabled: False
  - Model compiled: False
Training for 100 epochs...
Loss weights - Gloss: 0.5, Category: 0.5
------------------------------------------------------------
Epoch  1/100 | Train Loss: 3.4921 | Val Loss: 3.4831 | Val Gloss Acc: 0.007 | Val Cat Acc: 0.115 | Time: 24.3s
Epoch  2/100 | Train Loss: 3.4168 | Val Loss: 3.3249 | Val Gloss Acc: 0.012 | Val Cat Acc: 0.216 | Time: 24.7s
Epoch  3/100 | Train Loss: 3.2829 | Val Loss: 3.2018 | Val Gloss Acc: 0.009 | Val Cat Acc: 0.242 | Time: 24.7s
Epoch  4/100 | Train Loss: 3.1836 | Val Loss: 3.0975 | Val Gloss Acc: 0.028 | Val Cat Acc: 0.265 | Time: 24.6s
Epoch  5/100 | Train Loss: 3.1010 | Val Loss: 3.0489 | Val Gloss Acc: 0.028 | Val Cat Acc: 0.263 | Time: 23.6s
Epoch  6/100 | Train Loss: 2.9975 | Val Loss: 2.9059 | Val Gloss Acc: 0.014 | Val Cat Acc: 0.326 | Time: 25.4s
Epoch  7/100 | Train Loss: 2.9203 | Val Loss: 2.8593 | Val Gloss Acc: 0.045 | Val Cat Acc: 0.369 | Time: 23.7s
Epoch  8/100 | Train Loss: 2.8033 | Val Loss: 2.6859 | Val Gloss Acc: 0.047 | Val Cat Acc: 0.423 | Time: 26.2s
Epoch  9/100 | Train Loss: 2.7008 | Val Loss: 2.7322 | Val Gloss Acc: 0.042 | Val Cat Acc: 0.354 | Time: 24.1s
Epoch 10/100 | Train Loss: 2.6521 | Val Loss: 2.5169 | Val Gloss Acc: 0.068 | Val Cat Acc: 0.481 | Time: 24.3s
Epoch 11/100 | Train Loss: 2.5352 | Val Loss: 2.4451 | Val Gloss Acc: 0.106 | Val Cat Acc: 0.446 | Time: 24.2s
Epoch 12/100 | Train Loss: 2.4728 | Val Loss: 2.3634 | Val Gloss Acc: 0.099 | Val Cat Acc: 0.462 | Time: 23.8s
Epoch 13/100 | Train Loss: 2.4495 | Val Loss: 2.4305 | Val Gloss Acc: 0.115 | Val Cat Acc: 0.427 | Time: 24.0s
Epoch 14/100 | Train Loss: 2.3199 | Val Loss: 2.1952 | Val Gloss Acc: 0.164 | Val Cat Acc: 0.514 | Time: 24.0s
Epoch 15/100 | Train Loss: 2.2460 | Val Loss: 2.1922 | Val Gloss Acc: 0.153 | Val Cat Acc: 0.542 | Time: 25.2s
Epoch 16/100 | Train Loss: 2.1210 | Val Loss: 2.1852 | Val Gloss Acc: 0.138 | Val Cat Acc: 0.528 | Time: 25.1s
Epoch 17/100 | Train Loss: 2.1124 | Val Loss: 2.0273 | Val Gloss Acc: 0.207 | Val Cat Acc: 0.573 | Time: 23.5s
Epoch 18/100 | Train Loss: 2.0792 | Val Loss: 1.9804 | Val Gloss Acc: 0.216 | Val Cat Acc: 0.563 | Time: 24.1s
Epoch 19/100 | Train Loss: 2.0018 | Val Loss: 1.8880 | Val Gloss Acc: 0.200 | Val Cat Acc: 0.606 | Time: 24.0s
Epoch 20/100 | Train Loss: 1.9195 | Val Loss: 1.9090 | Val Gloss Acc: 0.225 | Val Cat Acc: 0.575 | Time: 24.6s
Epoch 21/100 | Train Loss: 1.8883 | Val Loss: 1.8303 | Val Gloss Acc: 0.216 | Val Cat Acc: 0.622 | Time: 25.6s
Epoch 22/100 | Train Loss: 1.8503 | Val Loss: 1.8031 | Val Gloss Acc: 0.244 | Val Cat Acc: 0.582 | Time: 24.4s
Epoch 23/100 | Train Loss: 1.7763 | Val Loss: 1.8712 | Val Gloss Acc: 0.237 | Val Cat Acc: 0.601 | Time: 25.8s
Epoch 24/100 | Train Loss: 1.7317 | Val Loss: 1.7687 | Val Gloss Acc: 0.249 | Val Cat Acc: 0.617 | Time: 23.9s
Epoch 25/100 | Train Loss: 1.7051 | Val Loss: 1.7791 | Val Gloss Acc: 0.258 | Val Cat Acc: 0.610 | Time: 24.5s
Epoch 26/100 | Train Loss: 1.6577 | Val Loss: 1.7380 | Val Gloss Acc: 0.286 | Val Cat Acc: 0.606 | Time: 24.1s
Epoch 27/100 | Train Loss: 1.6044 | Val Loss: 1.8164 | Val Gloss Acc: 0.246 | Val Cat Acc: 0.627 | Time: 24.9s
Epoch 28/100 | Train Loss: 1.5989 | Val Loss: 1.6845 | Val Gloss Acc: 0.268 | Val Cat Acc: 0.662 | Time: 26.8s
Epoch 29/100 | Train Loss: 1.6001 | Val Loss: 1.7225 | Val Gloss Acc: 0.265 | Val Cat Acc: 0.610 | Time: 24.6s
Epoch 30/100 | Train Loss: 1.5155 | Val Loss: 1.6300 | Val Gloss Acc: 0.298 | Val Cat Acc: 0.662 | Time: 23.7s
Epoch 31/100 | Train Loss: 1.5016 | Val Loss: 1.6714 | Val Gloss Acc: 0.296 | Val Cat Acc: 0.655 | Time: 27.5s
Epoch 32/100 | Train Loss: 1.4895 | Val Loss: 1.6184 | Val Gloss Acc: 0.289 | Val Cat Acc: 0.667 | Time: 26.4s
Epoch 33/100 | Train Loss: 1.4510 | Val Loss: 1.6106 | Val Gloss Acc: 0.282 | Val Cat Acc: 0.669 | Time: 25.7s
Epoch 34/100 | Train Loss: 1.3860 | Val Loss: 1.5543 | Val Gloss Acc: 0.329 | Val Cat Acc: 0.662 | Time: 26.6s
Epoch 35/100 | Train Loss: 1.3768 | Val Loss: 1.5865 | Val Gloss Acc: 0.300 | Val Cat Acc: 0.669 | Time: 24.4s
Epoch 36/100 | Train Loss: 1.3173 | Val Loss: 1.4887 | Val Gloss Acc: 0.329 | Val Cat Acc: 0.707 | Time: 24.3s
Epoch 37/100 | Train Loss: 1.3017 | Val Loss: 1.4672 | Val Gloss Acc: 0.347 | Val Cat Acc: 0.707 | Time: 24.2s
Epoch 38/100 | Train Loss: 1.2786 | Val Loss: 1.5870 | Val Gloss Acc: 0.343 | Val Cat Acc: 0.648 | Time: 24.2s
Epoch 39/100 | Train Loss: 1.2384 | Val Loss: 1.5008 | Val Gloss Acc: 0.333 | Val Cat Acc: 0.697 | Time: 24.4s
Epoch 40/100 | Train Loss: 1.2410 | Val Loss: 1.4823 | Val Gloss Acc: 0.343 | Val Cat Acc: 0.692 | Time: 24.2s
Epoch 41/100 | Train Loss: 1.1544 | Val Loss: 1.4843 | Val Gloss Acc: 0.366 | Val Cat Acc: 0.704 | Time: 24.1s
Epoch 42/100 | Train Loss: 1.1711 | Val Loss: 1.4409 | Val Gloss Acc: 0.350 | Val Cat Acc: 0.702 | Time: 23.7s
Epoch 43/100 | Train Loss: 1.1147 | Val Loss: 1.4755 | Val Gloss Acc: 0.380 | Val Cat Acc: 0.695 | Time: 24.3s
Epoch 44/100 | Train Loss: 1.1471 | Val Loss: 1.4350 | Val Gloss Acc: 0.376 | Val Cat Acc: 0.697 | Time: 23.9s
Epoch 45/100 | Train Loss: 1.0993 | Val Loss: 1.4139 | Val Gloss Acc: 0.401 | Val Cat Acc: 0.716 | Time: 24.3s
Epoch 46/100 | Train Loss: 1.0423 | Val Loss: 1.3350 | Val Gloss Acc: 0.423 | Val Cat Acc: 0.723 | Time: 23.8s
Epoch 47/100 | Train Loss: 1.0038 | Val Loss: 1.3303 | Val Gloss Acc: 0.441 | Val Cat Acc: 0.725 | Time: 24.0s
Epoch 48/100 | Train Loss: 1.0046 | Val Loss: 1.3202 | Val Gloss Acc: 0.441 | Val Cat Acc: 0.744 | Time: 24.9s
Epoch 49/100 | Train Loss: 0.9789 | Val Loss: 1.3516 | Val Gloss Acc: 0.437 | Val Cat Acc: 0.730 | Time: 24.6s
Epoch 50/100 | Train Loss: 0.9680 | Val Loss: 1.3425 | Val Gloss Acc: 0.420 | Val Cat Acc: 0.742 | Time: 23.7s
Epoch 51/100 | Train Loss: 0.9327 | Val Loss: 1.2895 | Val Gloss Acc: 0.444 | Val Cat Acc: 0.754 | Time: 23.9s
Epoch 52/100 | Train Loss: 0.8885 | Val Loss: 1.2474 | Val Gloss Acc: 0.465 | Val Cat Acc: 0.749 | Time: 23.6s
Epoch 53/100 | Train Loss: 0.8747 | Val Loss: 1.2901 | Val Gloss Acc: 0.472 | Val Cat Acc: 0.770 | Time: 23.7s
Epoch 54/100 | Train Loss: 0.8954 | Val Loss: 1.2478 | Val Gloss Acc: 0.481 | Val Cat Acc: 0.744 | Time: 24.8s
Epoch 55/100 | Train Loss: 0.8345 | Val Loss: 1.3679 | Val Gloss Acc: 0.437 | Val Cat Acc: 0.721 | Time: 23.9s
Epoch 56/100 | Train Loss: 0.8147 | Val Loss: 1.3385 | Val Gloss Acc: 0.423 | Val Cat Acc: 0.732 | Time: 24.5s
Epoch 57/100 | Train Loss: 0.8135 | Val Loss: 1.3254 | Val Gloss Acc: 0.444 | Val Cat Acc: 0.751 | Time: 24.4s
Epoch 58/100 | Train Loss: 0.8166 | Val Loss: 1.1995 | Val Gloss Acc: 0.455 | Val Cat Acc: 0.758 | Time: 24.7s
Epoch 59/100 | Train Loss: 0.7797 | Val Loss: 1.2788 | Val Gloss Acc: 0.460 | Val Cat Acc: 0.758 | Time: 24.4s
Epoch 60/100 | Train Loss: 0.7868 | Val Loss: 1.3103 | Val Gloss Acc: 0.477 | Val Cat Acc: 0.751 | Time: 25.5s
Epoch 61/100 | Train Loss: 0.7699 | Val Loss: 1.3414 | Val Gloss Acc: 0.448 | Val Cat Acc: 0.737 | Time: 24.7s
Epoch 62/100 | Train Loss: 0.7358 | Val Loss: 1.1794 | Val Gloss Acc: 0.500 | Val Cat Acc: 0.765 | Time: 24.3s
Epoch 63/100 | Train Loss: 0.7334 | Val Loss: 1.1921 | Val Gloss Acc: 0.491 | Val Cat Acc: 0.775 | Time: 24.3s
Epoch 64/100 | Train Loss: 0.7228 | Val Loss: 1.3367 | Val Gloss Acc: 0.467 | Val Cat Acc: 0.735 | Time: 24.5s
Epoch 65/100 | Train Loss: 0.6727 | Val Loss: 1.1834 | Val Gloss Acc: 0.509 | Val Cat Acc: 0.772 | Time: 23.9s
Epoch 66/100 | Train Loss: 0.6698 | Val Loss: 1.2468 | Val Gloss Acc: 0.500 | Val Cat Acc: 0.765 | Time: 23.5s
Epoch 67/100 | Train Loss: 0.6384 | Val Loss: 1.3474 | Val Gloss Acc: 0.453 | Val Cat Acc: 0.746 | Time: 24.5s
Epoch 68/100 | Train Loss: 0.6695 | Val Loss: 1.2428 | Val Gloss Acc: 0.502 | Val Cat Acc: 0.779 | Time: 24.2s
Epoch 69/100 | Train Loss: 0.6131 | Val Loss: 1.2103 | Val Gloss Acc: 0.509 | Val Cat Acc: 0.768 | Time: 24.6s
Epoch 70/100 | Train Loss: 0.6055 | Val Loss: 1.2173 | Val Gloss Acc: 0.507 | Val Cat Acc: 0.756 | Time: 24.3s
Epoch 71/100 | Train Loss: 0.6279 | Val Loss: 1.0798 | Val Gloss Acc: 0.535 | Val Cat Acc: 0.791 | Time: 24.6s
Epoch 72/100 | Train Loss: 0.5981 | Val Loss: 1.2896 | Val Gloss Acc: 0.507 | Val Cat Acc: 0.763 | Time: 24.1s
Epoch 73/100 | Train Loss: 0.5685 | Val Loss: 1.2486 | Val Gloss Acc: 0.514 | Val Cat Acc: 0.763 | Time: 25.5s
Epoch 74/100 | Train Loss: 0.5700 | Val Loss: 1.2103 | Val Gloss Acc: 0.552 | Val Cat Acc: 0.786 | Time: 24.3s
Epoch 75/100 | Train Loss: 0.5246 | Val Loss: 1.2044 | Val Gloss Acc: 0.516 | Val Cat Acc: 0.789 | Time: 26.1s
Epoch 76/100 | Train Loss: 0.5536 | Val Loss: 1.1646 | Val Gloss Acc: 0.542 | Val Cat Acc: 0.793 | Time: 25.2s
Epoch 77/100 | Train Loss: 0.4966 | Val Loss: 1.1152 | Val Gloss Acc: 0.552 | Val Cat Acc: 0.789 | Time: 26.3s
Epoch 78/100 | Train Loss: 0.5159 | Val Loss: 1.1996 | Val Gloss Acc: 0.505 | Val Cat Acc: 0.791 | Time: 25.4s
Epoch 79/100 | Train Loss: 0.5333 | Val Loss: 1.2957 | Val Gloss Acc: 0.514 | Val Cat Acc: 0.770 | Time: 24.2s
Epoch 80/100 | Train Loss: 0.5314 | Val Loss: 1.1450 | Val Gloss Acc: 0.542 | Val Cat Acc: 0.791 | Time: 24.1s
Epoch 81/100 | Train Loss: 0.4910 | Val Loss: 1.2223 | Val Gloss Acc: 0.545 | Val Cat Acc: 0.775 | Time: 24.6s
Epoch 82/100 | Train Loss: 0.4593 | Val Loss: 1.2025 | Val Gloss Acc: 0.556 | Val Cat Acc: 0.789 | Time: 24.1s
Epoch 83/100 | Train Loss: 0.4557 | Val Loss: 1.2348 | Val Gloss Acc: 0.538 | Val Cat Acc: 0.791 | Time: 25.1s
Epoch 84/100 | Train Loss: 0.4472 | Val Loss: 1.1696 | Val Gloss Acc: 0.554 | Val Cat Acc: 0.796 | Time: 25.6s
Epoch 85/100 | Train Loss: 0.4639 | Val Loss: 1.1956 | Val Gloss Acc: 0.533 | Val Cat Acc: 0.805 | Time: 25.4s
Epoch 86/100 | Train Loss: 0.4378 | Val Loss: 1.2993 | Val Gloss Acc: 0.521 | Val Cat Acc: 0.786 | Time: 24.6s
Epoch 87/100 | Train Loss: 0.4152 | Val Loss: 1.1877 | Val Gloss Acc: 0.561 | Val Cat Acc: 0.793 | Time: 23.0s
Epoch 88/100 | Train Loss: 0.3893 | Val Loss: 1.0920 | Val Gloss Acc: 0.563 | Val Cat Acc: 0.812 | Time: 23.6s
Epoch 89/100 | Train Loss: 0.3989 | Val Loss: 1.2930 | Val Gloss Acc: 0.514 | Val Cat Acc: 0.791 | Time: 23.7s
Epoch 90/100 | Train Loss: 0.4055 | Val Loss: 1.1764 | Val Gloss Acc: 0.552 | Val Cat Acc: 0.793 | Time: 23.9s
Epoch 91/100 | Train Loss: 0.3926 | Val Loss: 1.2336 | Val Gloss Acc: 0.526 | Val Cat Acc: 0.789 | Time: 24.4s
Epoch 92/100 | Train Loss: 0.3880 | Val Loss: 1.1713 | Val Gloss Acc: 0.559 | Val Cat Acc: 0.810 | Time: 24.1s
Epoch 93/100 | Train Loss: 0.3789 | Val Loss: 1.2580 | Val Gloss Acc: 0.531 | Val Cat Acc: 0.791 | Time: 23.8s
Epoch 94/100 | Train Loss: 0.3562 | Val Loss: 1.2691 | Val Gloss Acc: 0.561 | Val Cat Acc: 0.796 | Time: 24.9s
Epoch 95/100 | Train Loss: 0.3427 | Val Loss: 1.3488 | Val Gloss Acc: 0.540 | Val Cat Acc: 0.786 | Time: 24.6s
Epoch 96/100 | Train Loss: 0.3736 | Val Loss: 1.2741 | Val Gloss Acc: 0.528 | Val Cat Acc: 0.791 | Time: 26.0s
Epoch 97/100 | Train Loss: 0.3655 | Val Loss: 1.1945 | Val Gloss Acc: 0.554 | Val Cat Acc: 0.822 | Time: 25.2s
Epoch 98/100 | Train Loss: 0.3705 | Val Loss: 1.3660 | Val Gloss Acc: 0.538 | Val Cat Acc: 0.805 | Time: 25.0s
Epoch 99/100 | Train Loss: 0.3654 | Val Loss: 1.2527 | Val Gloss Acc: 0.556 | Val Cat Acc: 0.810 | Time: 25.5s
Epoch 100/100 | Train Loss: 0.3392 | Val Loss: 1.2742 | Val Gloss Acc: 0.531 | Val Cat Acc: 0.798 | Time: 24.3s
------------------------------------------------------------
Training completed!