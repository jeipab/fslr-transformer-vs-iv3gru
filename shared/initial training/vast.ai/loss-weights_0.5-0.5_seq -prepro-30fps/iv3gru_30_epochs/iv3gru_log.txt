Using device: cuda
CUDA device: NVIDIA GeForce RTX 3060
CUDA memory: 12.5 GB
CUDA compute capability: 8.6
CUDA multiprocessors: 28
CUDA memory allocated: 0.00 GB
CUDA memory cached: 0.00 GB

============================================================
DATA LOADING
============================================================
✓ Loaded data successfully
  - Dataset type: IV3-GRU Features
  - Training folder: data/processed/keypoints_train
  - Validation folder: data/processed/keypoints_val
  - Feature key: X2048
  - Gloss classes: 105
  - Category classes: 10

============================================================
DATASET PREPARATION
============================================================
✓ Created datasets and data loaders
  - Batch size: 32
  - Training batches: 54
  - Validation batches: 14
  - Training dataset size: 1704 samples
  - Validation dataset size: 426 samples
  - Data format: [T, 2048] features

============================================================
MODEL SELECTION
============================================================
Available models:
- transformer: Multi-head attention transformer
- iv3_gru: InceptionV3 + GRU hybrid
✓ Using InceptionV3GRU model

================================================================================
COMPREHENSIVE TRAINING CONFIGURATION
================================================================================
Session Information:
  - Start time: 2025-09-17 16:03:09
  - Working directory: /workspace/fslr-transformer-vs-iv3gru
  - Command: /workspace/fslr-transformer-vs-iv3gru/training/train.py --model iv3_gru --features-train data/processed/keypoints_train --features-val data/processed/keypoints_val --labels-train-csv data/processed/train_labels.csv --labels-val-csv data/processed/val_labels.csv --feature-key X2048 --num-gloss 105 --num-cat 10 --epochs 30 --batch-size 32 --amp

System Information:
  - Platform: Linux-5.15.0-153-generic-x86_64-with-glibc2.39
  - Python version: 3.12.11 | packaged by conda-forge | (main, Jun  4 2025, 14:45:31) [GCC 13.3.0]
  - PyTorch version: 2.8.0+cu128
  - CUDA version: 12.8
  - cuDNN version: 91002
  - NumPy version: 2.2.6

Core Training Parameters:
  - Model: iv3_gru
  - Epochs: 30
  - Batch size: 32
  - Learning rate: 0.0001
  - Weight decay: 0.0
  - Gradient clipping: None
  - Loss weights - Alpha: 0.5, Beta: 0.5

IV3-GRU Model Parameters:
  - Hidden1: 16
  - Hidden2: 12
  - Dropout: 0.3
  - Pretrained backbone: True
  - Freeze backbone: True

Data Configuration:
  - Gloss classes: 105
  - Category classes: 10
  - Data source: Real data files
  - Training folder: data/processed/keypoints_train
  - Validation folder: data/processed/keypoints_val
  - Feature key: X2048

Training Control:
  - Scheduler: None
  - Scheduler patience: 5
  - Early stopping: None
  - Resume from: None

Performance Settings:
  - AMP (Mixed Precision): True
  - Model compilation: False
  - Gradient accumulation steps: 1
  - DataLoader workers: 0
  - Auto workers: False
  - Pin memory: False
  - Prefetch factor: None

Reproducibility:
  - Random seed: 42
  - Deterministic mode: False

Output Configuration:
  - Checkpoint directory: data/processed
  - CSV log file: None

Model Information:
  - Model type: InceptionV3GRU
  - Total parameters: 25,214,007
  - Trainable parameters: 101,743
  - Model size: 96.2 MB
================================================================================

============================================================
TRAINING START
============================================================
Training Configuration:
  - Gradient accumulation steps: 1
  - AMP enabled: True
  - Model compiled: False
  - CUDA memory before training: 0.10 GB
Training for 30 epochs...
Loss weights - Gloss: 0.5, Category: 0.5
------------------------------------------------------------
Epoch  1/30 | Train Loss: 3.4984 | Val Loss: 3.4672 | Val Gloss Acc: 0.005 | Val Cat Acc: 0.178 | Time: 6.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  2/30 | Train Loss: 3.4596 | Val Loss: 3.4349 | Val Gloss Acc: 0.007 | Val Cat Acc: 0.249 | Time: 5.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  3/30 | Train Loss: 3.4295 | Val Loss: 3.4074 | Val Gloss Acc: 0.007 | Val Cat Acc: 0.270 | Time: 5.5s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  4/30 | Train Loss: 3.3968 | Val Loss: 3.3825 | Val Gloss Acc: 0.016 | Val Cat Acc: 0.303 | Time: 5.3s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  5/30 | Train Loss: 3.3753 | Val Loss: 3.3586 | Val Gloss Acc: 0.028 | Val Cat Acc: 0.322 | Time: 5.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  6/30 | Train Loss: 3.3503 | Val Loss: 3.3342 | Val Gloss Acc: 0.019 | Val Cat Acc: 0.369 | Time: 5.5s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  7/30 | Train Loss: 3.3322 | Val Loss: 3.3141 | Val Gloss Acc: 0.019 | Val Cat Acc: 0.390 | Time: 5.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  8/30 | Train Loss: 3.3047 | Val Loss: 3.2892 | Val Gloss Acc: 0.023 | Val Cat Acc: 0.415 | Time: 5.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch  9/30 | Train Loss: 3.2889 | Val Loss: 3.2660 | Val Gloss Acc: 0.023 | Val Cat Acc: 0.481 | Time: 5.9s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 10/30 | Train Loss: 3.2664 | Val Loss: 3.2408 | Val Gloss Acc: 0.035 | Val Cat Acc: 0.469 | Time: 5.5s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 11/30 | Train Loss: 3.2478 | Val Loss: 3.2192 | Val Gloss Acc: 0.045 | Val Cat Acc: 0.498 | Time: 6.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 12/30 | Train Loss: 3.2198 | Val Loss: 3.1927 | Val Gloss Acc: 0.042 | Val Cat Acc: 0.528 | Time: 6.2s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 13/30 | Train Loss: 3.1976 | Val Loss: 3.1633 | Val Gloss Acc: 0.042 | Val Cat Acc: 0.556 | Time: 5.7s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 14/30 | Train Loss: 3.1645 | Val Loss: 3.1391 | Val Gloss Acc: 0.042 | Val Cat Acc: 0.559 | Time: 5.8s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 15/30 | Train Loss: 3.1455 | Val Loss: 3.1065 | Val Gloss Acc: 0.038 | Val Cat Acc: 0.603 | Time: 5.4s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 16/30 | Train Loss: 3.1162 | Val Loss: 3.0772 | Val Gloss Acc: 0.042 | Val Cat Acc: 0.624 | Time: 5.3s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 17/30 | Train Loss: 3.0914 | Val Loss: 3.0520 | Val Gloss Acc: 0.040 | Val Cat Acc: 0.671 | Time: 5.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 18/30 | Train Loss: 3.0568 | Val Loss: 3.0175 | Val Gloss Acc: 0.045 | Val Cat Acc: 0.707 | Time: 6.2s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 19/30 | Train Loss: 3.0416 | Val Loss: 2.9964 | Val Gloss Acc: 0.040 | Val Cat Acc: 0.716 | Time: 6.5s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 20/30 | Train Loss: 3.0054 | Val Loss: 2.9599 | Val Gloss Acc: 0.042 | Val Cat Acc: 0.798 | Time: 5.9s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 21/30 | Train Loss: 2.9794 | Val Loss: 2.9293 | Val Gloss Acc: 0.047 | Val Cat Acc: 0.791 | Time: 5.9s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 22/30 | Train Loss: 2.9587 | Val Loss: 2.8993 | Val Gloss Acc: 0.049 | Val Cat Acc: 0.833 | Time: 6.2s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 23/30 | Train Loss: 2.9370 | Val Loss: 2.8752 | Val Gloss Acc: 0.047 | Val Cat Acc: 0.847 | Time: 6.2s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 24/30 | Train Loss: 2.9062 | Val Loss: 2.8460 | Val Gloss Acc: 0.047 | Val Cat Acc: 0.869 | Time: 6.2s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 25/30 | Train Loss: 2.8774 | Val Loss: 2.8260 | Val Gloss Acc: 0.052 | Val Cat Acc: 0.852 | Time: 5.7s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 26/30 | Train Loss: 2.8601 | Val Loss: 2.8060 | Val Gloss Acc: 0.047 | Val Cat Acc: 0.815 | Time: 5.8s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 27/30 | Train Loss: 2.8370 | Val Loss: 2.7728 | Val Gloss Acc: 0.045 | Val Cat Acc: 0.897 | Time: 5.5s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 28/30 | Train Loss: 2.8135 | Val Loss: 2.7526 | Val Gloss Acc: 0.052 | Val Cat Acc: 0.883 | Time: 5.6s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 29/30 | Train Loss: 2.7900 | Val Loss: 2.7232 | Val Gloss Acc: 0.054 | Val Cat Acc: 0.904 | Time: 5.4s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
Epoch 30/30 | Train Loss: 2.7693 | Val Loss: 2.6955 | Val Gloss Acc: 0.056 | Val Cat Acc: 0.920 | Time: 5.2s
  GPU Memory: 0.12GB allocated, 0.29GB reserved
------------------------------------------------------------
Training completed!