Expose port "8501" in your Vast AI Template

Set-up code base:
	Clone the repository:
		1. git clone https://github.com/jeipab/fslr-transformer-vs-iv3gru.git
	Change directory:
		2. cd fslr-transformer-vs-iv3gru
	Set up virtual environment:
		3. python -m venv venv
	Activate virtual environment:
		4. source venv/bin/activate
	Install dependencies:
		5. pip install -r requirements.txt


Upload zipped NPZ:
	Change directory
		1. cd workspace/fslr-transformer-vs-iv3gru/data/processed
	Install gdown
		2. pip install gdown
	Download zip file
		3. gdown https://drive.google.com/uc?id=1C_td2Jqb07Z19t-uaoE3m3y7cAnHOZwI
	Extract zip file
		4. unzip *.zip

Assign gloss and cat labels:
	Go back to project root
		1. cd ../../
		2. python data/splitting/assign.py

Run data split (greetings only):
	1. python data/splitting/data_split.py --processed-root data/processed --labels data/processed/labels.csv --out-root data/processed --copy --cats greeting --label-ref data/splitting/labels_reference.csv

Run data split (full):
	1. python data/splitting/data_split.py --processed-root data/processed --labels data/processed/labels.csv --out-root data/processed --copy --label-ref data/splitting/labels_reference.csv

Train Tranformer (high accuracy):
python -m training.train \
  --model transformer \
  --epochs 300 \
  --batch-size 8 \
  --lr 0.00006 \
  --alpha 0.8 \
  --beta 0.2 \
  --num-gloss 105 \
  --num-cat 10 \
  --keypoints-train data/processed/keypoints_train \
  --keypoints-val data/processed/keypoints_val \
  --labels-train-csv data/processed/train_labels.csv \
  --labels-val-csv data/processed/val_labels.csv \
  --kp-key X2048 \
  --amp \
  --augment \
  --augment-noise-std 0.001 \
  --augment-mask-prob 0.03 \
  --augment-mask-ratio 0.03 \
  --scheduler warmup_cosine \
  --warmup-epochs 20 \
  --early-stop 150 \
  --weight-decay 1.1e-4 \
  --log-csv transformer_full_features_ultra_fine.csv \
  --output-dir trained_models/transformer/full_with_features_ultra_fine

Train IV3-GRU (low gloss accuracy):
python -m training.train \
  --model iv3_gru \
  --epochs 200 \
  --batch-size 8 \
  --lr 0.0001 \
  --alpha 0.8 \
  --beta 0.2 \
  --num-gloss 105 \
  --num-cat 10 \
  --features-train data/processed/keypoints_train \
  --features-val data/processed/keypoints_val \
  --labels-train-csv data/processed/train_labels.csv \
  --labels-val-csv data/processed/val_labels.csv \
  --feature-key X2048 \
  --hidden1 16 \
  --hidden2 12 \
  --dropout 0.3 \
  --amp \
  --augment \
  --augment-noise-std 0.002 \
  --augment-mask-prob 0.05 \
  --augment-mask-ratio 0.05 \
  --scheduler plateau \
  --scheduler-patience 20 \
  --early-stop 100 \
  --weight-decay 1e-5 \
  --log-csv iv3gru_full_final_fixed.csv \
  --output-dir trained_models/iv3_gru/full_final_fixed

Train IV3-GRU (???):
python -m training.train \
  --model iv3_gru \
  --epochs 300 \
  --batch-size 16 \
  --lr 0.0003 \
  --alpha 0.8 \
  --beta 0.2 \
  --num-gloss 105 \
  --num-cat 10 \
  --features-train data/processed/keypoints_train \
  --features-val data/processed/keypoints_val \
  --labels-train-csv data/processed/train_labels.csv \
  --labels-val-csv data/processed/val_labels.csv \
  --feature-key X2048 \
  --hidden1 32 \
  --hidden2 24 \
  --dropout 0.2 \
  --no-freeze-backbone \
  --amp \
  --augment \
  --augment-noise-std 0.001 \
  --augment-mask-prob 0.03 \
  --augment-mask-ratio 0.03 \
  --scheduler plateau \
  --scheduler-patience 25 \
  --early-stop 150 \
  --weight-decay 5e-6 \
  --log-csv iv3gru_full_optimized.csv \
  --output-dir trained_models/iv3_gru/full_optimized

Add missing files:
1. Data
2. Trained models
3. Replace validation

Run streamlit app.
1. streamlit run run_app.py --server.port 8081 --server.address 0.0.0.0

Create a new tunnel.
1. http://localhost:8081
3. https://capable-oasis-aaa-load.trycloudflare.com


OPTIONAL:
Test IV3-GRU:
python -c "
try:
    from evaluation.prediction.predict import ModelPredictor
    predictor = ModelPredictor('iv3_gru', 'trained_models/iv3_gru/iv3gru_100_epochs_09-16/InceptionV3GRU_best.pt', device='cpu')
    print('IV3-GRU loaded successfully on CPU')
except Exception as e:
    print('IV3-GRU loading failed:', str(e))
"

Fix for video generation:
apt-get update && apt-get install -y ffmpeg libx264-dev